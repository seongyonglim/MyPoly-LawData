# 정치성향 프로필 시스템 분석

> 사용자 정치성향 테스트 및 점수 계산 시스템

## 개요

현재 코드에서 확인된 정치성향 시스템 구조를 정리합니다.

---

## 현재 구현된 부분

### 1. 의안별 정치성향 가중치 생성 (AI)

**위치**: `AI/20251008_Gemini/bill_headline_summarizer.py`

**기능**: 각 의안에 대해 찬성/반대 투표 시 정치성향에 미치는 영향을 계산

**출력 형식**:
```json
{
  "vote": {
    "for": {"P": 1, "U": 1},      // 찬성 시 +1 점수 줄 축들
    "against": {"M": 1, "T": 1}   // 반대 시 +1 점수 줄 축들
  }
}
```

**정치성향 축 (8개, 4쌍)**:
- **P** (공공 중심) / **M** (시장 중심)
- **U** (보편 적용) / **T** (대상 맞춤)
- **N** (필요 기반) / **S** (성과 기반)
- **O** (개방 실험) / **R** (절차 안정)

**가중치 규칙**:
- 같은 축에서 양쪽을 동시에 넣지 않음 (P와 M 동시 선택 불가)
- 1~3개 축을 선택하여 +1 가중치 부여 (기본 2개 권장)
- 찬성("for"): 의안의 핵심 변화 방향과 부합하는 축
- 반대("against"): 거울 반대 축 또는 특정 가치 강화 축

---

## 사용자 정치성향 초기 테스트

### 2. 테스트 진행 방식

**방식**: MBTI 테스트와 유사하게 사용자가 테스트를 진행하고 결과값을 받음

**프로세스**:
1. 사용자가 정치성향 테스트 시작
2. 설문 질문에 응답 (질문 구성은 추후 정의)
3. 응답을 바탕으로 초기 점수 계산
4. 결과값 반환 및 저장

### 3. 초기 점수 계산 로직

**계산 방식**: 배타적 쌍에서 한쪽은 +, 다른 쪽은 -

**예시**:
- 질문에 "공공 중심" 응답 → **P +1, M -1**
- 질문에 "시장 중심" 응답 → **M +1, P -1**
- 질문에 "보편 적용" 응답 → **U +1, T -1**
- 질문에 "대상 맞춤" 응답 → **T +1, U -1**

**초기 점수 범위**:
- **각 축별 5점씩 부여** (총 8개 축)
- 예: P=5, M=0, U=3, T=2, N=4, S=1, O=2, R=3 (각 축별 합계 5점)

**점수 저장**:
- `user_political_profile` 테이블에 저장
- 8개 축별 점수 (p_score, m_score, u_score, t_score, n_score, s_score, o_score, r_score)

---

## 사용자 투표 시 점수 업데이트

### 4. 투표 시 점수 업데이트 로직

**예상 로직**:
```
1. 사용자가 의안에 찬성/반대 투표
   ↓
2. 해당 의안의 vote_for 또는 vote_against 가중치 조회
   ↓
3. 사용자의 정치성향 점수에 가중치 추가
   예: vote_for = {"P": 1, "U": 1}
       → p_score += 1, u_score += 1
   ↓
4. user_political_profile 테이블 업데이트
```

**DB 구조**:
```sql
CREATE TABLE user_political_profile (
    user_id VARCHAR(100) PRIMARY KEY,
    p_score INT DEFAULT 0 COMMENT '공공 중심 (P) 점수 (초기 0~5)',
    m_score INT DEFAULT 0 COMMENT '시장 중심 (M) 점수 (초기 0~5)',
    u_score INT DEFAULT 0 COMMENT '보편 적용 (U) 점수 (초기 0~5)',
    t_score INT DEFAULT 0 COMMENT '대상 맞춤 (T) 점수 (초기 0~5)',
    n_score INT DEFAULT 0 COMMENT '필요 기반 (N) 점수 (초기 0~5)',
    s_score INT DEFAULT 0 COMMENT '성과 기반 (S) 점수 (초기 0~5)',
    o_score INT DEFAULT 0 COMMENT '개방 실험 (O) 점수 (초기 0~5)',
    r_score INT DEFAULT 0 COMMENT '절차 안정 (R) 점수 (초기 0~5)',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

**초기 점수 예시**:
```json
{
  "p_score": 5,  // 공공 중심 5점
  "m_score": 0,  // 시장 중심 0점
  "u_score": 3,  // 보편 적용 3점
  "t_score": 2,  // 대상 맞춤 2점
  "n_score": 4,  // 필요 기반 4점
  "s_score": 1,  // 성과 기반 1점
  "o_score": 2,  // 개방 실험 2점
  "r_score": 3   // 절차 안정 3점
}
```

---

## 점수 업데이트 규칙

### 투표 시 점수 누적

**규칙**:
- 사용자가 의안에 투표할 때마다 점수가 **누적**됨
- 찬성 투표: 해당 의안의 `vote_for` 가중치를 점수에 추가
- 반대 투표: 해당 의안의 `vote_against` 가중치를 점수에 추가

**예시**:
```
초기 점수: P=5, M=0, U=3, T=2

의안 A에 찬성 투표
→ vote_for = {"P": 1, "U": 1}
→ P=6, M=0, U=4, T=2

의안 B에 반대 투표
→ vote_against = {"M": 1, "T": 1}
→ P=6, M=1, U=4, T=3
```

**점수 범위**:
- 초기: 각 축별 0~5점
- 투표 후: 무제한 누적 가능 (음수 가능성 있음)
- 점수 범위 제한 여부는 추후 결정

---

## 확인 필요 사항

### ❓ 질문

1. **정치성향 테스트 설문 구성** (추후 전달 예정)
   - 질문 개수
   - 각 질문의 선택지
   - 응답 → 점수 변환 로직

2. **점수 범위 제한**
   - 투표 후 점수가 무제한 누적되는가?
   - 최소/최대 점수 제한이 필요한가?
   - 시간이 지나면 점수가 감소하나요?

---

## 현재까지 파악한 내용

### ✅ 확인됨
- 의안별 정치성향 가중치 생성 (AI)
- 8개 축 정의 (P/M/U/T/N/S/O/R)
- 가중치 부여 규칙
- DB 테이블 설계 (`user_political_profile`)
- **테스트 진행 방식** (MBTI 방식)
- **초기 점수 계산 로직** (배타적 쌍: P+1/M-1 방식)
- **초기 점수 범위** (각 축별 5점씩)
- **투표 시 점수 누적** (vote_for/vote_against 가중치 추가)

### ⏳ 추후 전달 예정
- 정치성향 테스트 설문 구성 (질문 개수, 선택지, 변환 로직)
- 점수 범위 제한 여부
- 의원과의 일치율 계산 방법

---

## 다음 단계

1. **정치성향 테스트 설문 정의** (추후 전달 예정)
   - 질문 목록 작성
   - 응답 → 점수 변환 로직 정의

2. **초기 점수 계산 로직 구현**
   - 설문 응답 처리
   - 배타적 쌍 점수 계산 (P+1/M-1 방식)
   - 각 축별 5점 범위 내 점수 계산
   - `user_political_profile` 테이블에 저장

3. **투표 시 점수 업데이트 로직 구현**
   - 사용자 투표 → 의안의 `vote_for`/`vote_against` 가중치 조회
   - 점수 누적 업데이트
   - `user_political_profile` 테이블 업데이트

4. **의원 일치율 계산** (추후 구현)
   - 사용자 점수 vs 의원 점수 비교
   - 일치율 계산 알고리즘

---

## 시스템 요약

### 전체 흐름

```
1. 사용자 정치성향 테스트 (초기)
   ↓
   설문 응답 → 배타적 쌍 점수 계산 (P+1/M-1)
   ↓
   각 축별 5점씩 부여
   ↓
   user_political_profile 테이블에 저장

2. 사용자 의안 투표
   ↓
   의안의 vote_for 또는 vote_against 가중치 조회
   ↓
   점수 누적 업데이트
   ↓
   user_political_profile 테이블 업데이트

3. 의원 일치율 계산 (추후)
   ↓
   사용자 점수 vs 의원 점수 비교
```

### 핵심 규칙

- **초기 점수**: 각 축별 5점씩 (배타적 쌍 방식)
- **투표 가중치**: 의안별 1~3개 축 선택, 각 +1
- **점수 누적**: 투표할 때마다 가중치 추가 (무제한 누적)

